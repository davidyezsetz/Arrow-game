$(function(){var e=$("body").height(),t=e/2-375;$("#wrapper").css({top:t+"px",display:"block"})});$(function(){"use strict";function e(){this.arrows=[{id:$("#arrow-left"),dir:"right"},{id:$("#arrow-top"),dir:"bottom"},{id:$("#arrow-right"),dir:"left"},{id:$("#arrow-bottom"),dir:"top"}];Modernizr.rgba?this.colors={base:"rgba( 27, 50, 71, 0.7 )",highlight:"rgba( 148, 225, 255, 0.7 )",fail:"rgba( 255, 0, 0, 0.7 )"}:this.colors={base:"rgb( 20, 37, 53 )",highlight:"rgb( 137, 208, 235 )",fail:"#f00"};this.keyMap={37:1,38:2,39:3,40:4,65:1,87:2,68:3,83:4,72:1,75:2,76:3,74:4};this.targetKey=0;this.pressedKey=0;this.score=0;this.scoreMultiplier=100;this.duration=60;this.activeGame=!1;this.countdown=!1;this.level=1;this.xp=0;this.lastInput=0;this.timer=$("#timer");this.scoreUi=$("#score");this.levelUi=$("#level");this.canvas=$("#starfield");this.menu=$("#menu");this.endScreen=$("#end-screen")}e.prototype.setTarget=function(){var e=this.arrows[this.targetKey];this.colorize(e.id,e.dir,this.colors.base);var t;for(var n=1;n<1e3;n++){t=Math.floor(Math.random()*4);if(t!==this.targetKey)break}this.targetKey=t;var r=this.arrows[this.targetKey];this.colorize(r.id,r.dir,this.colors.highlight)};e.prototype.colorize=function(e,t,n){e.css("border-"+t+"-color",n)};e.prototype.updateScore=function(){var e=(new Date).getTime(),t=e-this.lastInput,n=(1e4-t*10)/10;this.lastInput=e;this.score=this.score+this.scoreMultiplier*this.level+n;this.scoreUi.html(this.score);this.xp++;if(this.xp===10+this.level){this.level++;this.xp=0;this.canvas.trigger("levelUp");this.levelUi.html(this.level)}};e.prototype.pulse=function(){var e=this,t=this.duration;this.countdown=setInterval(function(){if(t===0)e.gameOver(!0,!1);else{t--;e.timer.html(t+"s")}},1e3)};e.prototype.reset=function(){var e=this,t=this.arrows[this.targetKey];this.colorize(t.id,t.dir,this.colors.base);this.targetKey=0;this.countdown=!1;this.activeGame=!1;this.score=0;this.level=1;this.xp=0;this.menu.removeClass("move--up");this.endScreen.removeClass("move--up");$(document).unbind("keydown");e.init()};e.prototype.gameOver=function(e,t){var n=this.arrows[t],r=this,i="<h1>Game Over</h1>Score: "+this.score+"<br/>Press space or enter to play again";clearInterval(this.countdown);e||this.colorize(n.id,n.dir,this.colors.fail);this.canvas.trigger("levelReset");this.menu.addClass("move--up");this.endScreen.html(i).addClass("move--up");$(document).unbind("keydown");$(document).bind("keydown",function(t){if(t.keyCode===32||t.keyCode===13){e||r.colorize(n.id,n.dir,r.colors.base);r.reset()}})};e.prototype.init=function(){var e=this;this.timer.html(this.duration+"s");this.scoreUi.html(this.score);this.levelUi.html(this.level);this.colorize(this.arrows[0].id,this.arrows[0].dir,this.colors.highlight);$(document).bind("keydown",function(t){var n=e.keyMap[t.keyCode];if(n){t.preventDefault();if(!e.activeGame){e.pulse();e.activeGame=!0;e.lastInput=(new Date).getTime()}if(n-1===e.targetKey){e.updateScore();e.setTarget()}else e.gameOver(!1,n-1)}})};var t=new e;t.init()});$(function(){"strict mode";function c(n){n.x=(Math.random()*e-e*.5)*u;n.y=(Math.random()*t-t*.5)*u;n.z=u;n.px=0;n.py=0}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e)}}();var e=window.innerWidth,t=window.innerHeight,n=document.getElementById("starfield"),r=e/2,i=t/2;n.width=e;n.height=t;var s=n.getContext("2d");s.globalAlpha=.25;var o=25,u=25,a=500,f=[],l=.025+.08;$(n).bind("levelUp",function(){u>4&&(u-=2.5)});$(n).bind("levelReset",function(){u=o});for(var h=0,p;h<a;h++){p={};c(p);f.push(p)}var d=function(){s.fillStyle="#000";s.fillRect(0,0,e,t);var n=r-e/2+e/2,o=i-t/2+t/2,u=Math.floor(l*500);u>100&&(u=100);for(var h=0;h<a;h++){var p=f[h],v=p.x/p.z,m=p.y/p.z,g=(1/p.z+1)*2;if(p.px!==0){s.strokeStyle="rgb(255, 255, 255)";s.lineWidth=g;s.beginPath();s.moveTo(v+n,m+o);s.lineTo(p.px+n,p.py+o);s.stroke()}p.px=v;p.py=m;p.z-=l;(p.z<l||p.px>e||p.py>t)&&c(p)}window.requestAnimFrame(d)};Modernizr.canvas&&window.requestAnimFrame(d)});